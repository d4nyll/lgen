<template name="MessageDetail">
                {{#if showTimestamp}}
                       <div class='date-bubble-wrapper'> <div class='date-bubble'>{{formatDate sendAt}}</div> </div>
                {{/if}}
                                      
                <div class="list card less-top-bottom-padding less-top-bottom-margin {{reactive}}">
                     

                    <div class="item less-top-bottom-padding">
                    <div>
                        <i class="icon {{isNewMessage sendAt}} new-message-icon"></i>
                        {{{docPreview data.content}}}                     
                        {{#autolink}}<span class='content'><pre>{{data.content}}</pre></span>{{/autolink}}
                    </div>
                    <div>
                        <div>
                        
                            {{#each attachImages}}
                            {{#with getImage}}
                                {{#if this.isUploaded}}
                                {{#if this.hasStored 'images'}}
                                    <div class="">
                                    <img src="{{this.url store='thumbs'  }}" alt="" class="imgThumbs responsive-img"
                                        data-fullsizeimage="{{this.url  }}">
                                    <!-- <a class="button button-icon icon ion-close-circled image" data-imgid="{{_id}}"></a> -->
                                    </div>
                                {{/if}}
                                {{/if}}
                            {{/with}}
                            {{/each}}
                        
                        </div>
                        <div>
                        
                            {{#each attachVoices}}
                            {{#with getSound}}
                                {{#if this.isUploaded}}
                                {{#if this.hasStored 'sounds'}}
                                    {{#if  this.url}}
                                    {{#if isCordova}}
                                        <div class="bubble">
                                        <a class="button button-icon icon ion-play playBtn" data-clipid="{{_id}}"></a>
                                        <!-- <a class="button button-icon icon ion-close-circled voice" data-clipid="{{_id}}"></a> -->
                                        </div>                    
                                    {{else}}
                                        <div class="bubble">
                                        <audio controls>
                                            <source src="{{this.url}}" type="audio/wav">
                                        </audio>
                                        <!-- <a class="button button-icon icon ion-close-circled voice" data-clipid="{{_id}}"></a> -->
                                        </div>                                                                                    
                                    {{/if}}
                                    {{/if}} 
                                {{/if}}
                                {{/if}}
                            {{/with}}
                            {{/each}}
                        
                        </div>
                        <div class='document'>
                        
                            {{#each attachDocuments}}
                            {{#with getDocument}}
                                {{#if this.isUploaded}}
                                {{#if this.hasStored 'documents'}}                           
                                    <div class="bubble">
                                    <a href='{{this.url}}'> <i class="icon ion-ios-download-outline"></i>&nbsp;{{this.name}}</a>
                                    <br/><span  class='timestamp'>{{formatTime  ../sendAt}}</span>                       
                                    </div>                                   
                                {{/if}}                      
                                {{/if}}
                            {{/with}}
                            {{/each}}
                                              
                        </div>
                        <div>
                            {{#each attachCalendar}}
                            <div class="item ">
                                <div class="row" style="padding:0">
                                    <div class="col" style="padding:0"><h2><i class='icon ion-ios-calendar-outline' ></i>{{eventName}}</h2></div>
                                    <div class="col" style="padding:0"><h2><i class='icon ion-location' ></i>{{location}}</h2></div>
                                    <div class="col" style="padding:0;text-align:right">{{startDate}}</div>
                                    <div class="col" style="padding:0;text-align:right">{{endDate}}</div>                                                                   
                                    <div class="col" style="padding:0;text-align:right"><button class='add-to-calendar' data-start-date='{{startDate}}' data-end-date='{{endDate}}' data-event-name='{{eventName}}' data-event-location='{{location}}' data-description='{{../data.content}}'>Add to calendar</button></div>
                                </div>
                            </div>
                            {{/each}}                            
                        </div>               
                    </div>
                    

                    <p>
                        {{#each attachVotes}}
                            {{> AppDisplayVote this.vote}} 
                        {{/each}}
                        <span class='timestamp'>{{formatTime sendAt}}</span>  
                    </p>
                    </div>
                    
                    <!--Voting Area-->                              
                    {{#each attachVotes}}
                        {{#if this.vote.allowVote}}
                        <div class="votingSection item tabs tabs-secondary tabs-icon-left">
                         {{> AppChangeVote vote=this.vote messageId=msgId}}
                        </div>                     
                        {{/if}}                   
                    {{/each}}
                        
                   
                    <!--Voting Area End-->
                    
                    <!--Display comments count-->
                    {{#if this.comment.allowComment}}
                    <div class="item less-top-bottom-padding">
                        <a class='smaller comment-counter subdued'>{{_ "CommentCounter" comment_count=this.comment.comments.length }}</a>
                    </div>
                    <!--<div  class="item less-top-bottom-padding">
                        <button class='button button-small commentToggleBtn'><i class='icon ion-chatbox'></i>Comment</button>
                    </div>-->
                    {{/if}}
                    <!--Display comments count end-->
                    
                    <section data-msgid={{msgId}} class="commentSection hidden">
                    <!--Display existing comments-->
                    
                    {{#with this.comment}}
                        {{#each this.comments}}
                          
                              {{#if this.isShown}}
                               <div class="item item-avatar less-top-bottom-padding {{@index}} ">                    
                                <h3>{{getNameById this.createdBy}}</h3>
                                <p> {{this.comment}}</p>
                                <p> {{formatTimeFromNow this.createdAt}}</p>
                               </div>
                             {{else}}
                              <div class="item item-avatar less-top-bottom-padding {{@index}} " style='min-height:0px'>
                               <p> {{_ "ThisCommentIsHidden"}}</p>
                              </div>
                             {{/if}}
                            
                        {{/each}}
                    {{/with}}
                    <!--Display existing comments end-->


                    </section>                    
                    <!--Add comment-->
                    {{#if this.comment.allowComment}}
                        <div class="item item-input-inset">
                            <label class="item-input-wrapper">
                                <input class='add-comment-annoucement-textbox' data-msgid={{msgId}} type="text" placeholder="...">
                            </label>
                            <button data-msgid={{msgId}} class='button button-small button-positive add-comment-annoucement'>{{_ "Comment"}}</button>
                        </div>                    
                    {{/if}}
                    <!--Add comment end-->                    
                </div>    
</template>