<template name="ClassPanel">

  
  {{#contentFor "headerTitle"}}
    <!-- new code to display classCode in small
    <div>
      <h1 class="title"
        style="top: -.5rem !important;overflow: visible !important;">
        {{classObj.className}}</h1>
      <br>
      <div class="title"
           style="font-size:smaller;position: absolute;left: 0;  right: 0;  top: 0.5rem;opacity:0.7">
        @{{classObj.classCode}}</div>
    </div>
    -->

    <h1 class="title">
  
      <i class="icon e1a-{{classObj.classAvatar}} e1a-2x emojicon"></i>
      {{classObj.className}}

    </h1>

  {{/contentFor}}
  {{#contentFor "headerButtonLeft"}}
    {{>ionNavBackButton path='TabClasses' text=" "}}
  {{/contentFor}}
  {{#contentFor "headerButtonRight"}}

    <div style="position: absolute; right: 0;">
     
      <a href="{{pathFor 'classEdit' classCode=classObj.classCode  }}"
         class="button button-clear button-entering button-active "><i class="icon ion-ios-information-outline"></i></a>

    </div>
  {{/contentFor}}
  
  {{#if Template.subscriptionsReady}}
  {{#ionView}}
    {{#ionContent}}
 

  

       
        <div class="list messageList background-wallpaper"  id="messageList">
           <!--<div class='date-bubble-wrapper {{isLoadMoreButtonShow}}'><button class='load-prev-msg'>Load Previous Messages</button> </div>          -->  
               {{#each classMessages}}
                {{#if showTimestamp}}
                       <div class='date-bubble-wrapper'> <div class='date-bubble'>{{formatDate sendAt}}</div> </div>
                {{/if}}                 
                <div class="item card less-top-bottom-padding less-top-bottom-margin">
                 {{#with calendarEvent}}
                 <div class="item ">
                    <div class="row" style="padding:0">
                        <div class="col" style="padding:0"><h2><i class='icon ion-ios-calendar-outline' ></i>{{eventName}}</h2></div>
                        <div class="col" style="padding:0"><h2><i class='icon ion-location' ></i>{{location}}</h2></div>
                        <div class="col" style="padding:0;text-align:right">{{startDate}} at {{startDateTime}}</div>
                        <div class="col" style="padding:0;text-align:right">{{endDate}} at {{endDateTime}}</div>                                                                   
                        <div class="col" style="padding:0;text-align:right"><button>Add to calendar</button></div>
                    </div>
                </div>
                {{/with}}
                <div class="item less-top-bottom-padding">
                    <div>
                    
                    {{{docPreview data.content}}}    
                    {{#autolink}}<div class='content'><pre>{{data.content}}</pre></div>{{/autolink}}
                    <div>
                        
                        
                            {{#each attachImages}}
                                {{#with getImage}}
                                {{#if this.isUploaded}}
                                    {{#if this.hasStored 'images'}}
                                    <div class="">
                                        <img src="{{this.url store='thumbs'  }}" alt="" class="imgThumbs responsive-img" data-fullsizeimage="{{this.url  }}">
                                        <!-- <a class="button button-icon icon ion-close-circled image" data-imgid="{{_id}}"></a> -->
                                    </div>
                                    {{/if}}
                                {{/if}}
                                {{/with}}
                            {{/each}}
                        
                    </div>
                    <div>
                        {{#if haveSound}}
                        {{#each soundArr}}
                            {{#with getSound}}
                            {{#if this.isUploaded}}
                                {{#if this.hasStored 'sounds'}}                           
                                {{#if  this.url}}
                                    {{#if isCordova}}
                                    <div class="bubble">
                                        <a class="button button-icon icon ion-play playBtn" data-clipid="{{_id}}"></a>
                                        <!-- <a class="button button-icon icon ion-close-circled voice" data-clipid="{{_id}}"></a> -->
                                    </div>                    
                                    {{else}}
                                    <div class="bubble">
                                        <audio controls>
                                        <source src="{{this.url}}" type="audio/wav">
                                        </audio>
                                        <!-- <a class="button button-icon icon ion-close-circled voice" data-clipid="{{_id}}"></a> -->
                                    </div>                                                                                    
                                    {{/if}}
                                {{/if}}                                 
                                {{/if}}                      
                            {{/if}}
                            {{/with}}
                        {{/each}}
                        {{/if}}
                    </div>
                    <div>
                        
                        {{#each attachDocuments}}
                            {{#with getDocument}}
                            {{#if this.isUploaded}}
                                    {{#if this.hasStored 'documents'}}                           
                                        <div class="bubble">
                                        <a href='{{this.url}}'> <i class="icon ion-ios-download-outline"></i>&nbsp;{{this.name}}</a>
                                        <br/><span  class='timestamp'>{{formatTime  ../sendAt}}</span>                       
                                        </div>
                                    {{else}}
                                        {{> LoadingSpinner}}                                  
                                    {{/if}}
                                {{else}}
                                        {{> LoadingSpinner}}             
                            {{/if}}
                            {{/with}}
                        {{/each}}
                                              
                    </div>
                    </div>
                    
                    <p>
                        {{#each attachVotes}}
                            {{> VoteDisplay this}}
                        {{/each}}
                        
                    <span class='timestamp'>{{formatTime sendAt}}</span>  
                    <span>
                         {{#if this.comment.allowComment}}
                             <a class='smaller comment-counter subdued'>{{_ "CommentCounter" comment_count=this.comment.comments.length }}</a>
                         {{/if}}
                        
                    </span>
                    </p>
                    
                </div>
                
                <div class='extraInfo {{showByDefaultIfWithComments}}'>
                    {{> MessageExtraInfo msgCode=msgId inputMessageObj=this }}
                </div>
                </div>
                <!-- </a> -->
              {{/each}}
        </div>
        
        
        {{> SendMessage callFromClassPanel=true }}

    {{/ionContent}}
  {{/ionView}}
  {{/if}}
</template>